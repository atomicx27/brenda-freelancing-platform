generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               String          @id @default(cuid())
  email            String          @unique
  password         String
  firstName        String
  lastName         String
  userType         UserType        @default(CLIENT)
  isVerified       Boolean         @default(false)
  isActive         Boolean         @default(true)
  status           UserStatus      @default(PENDING_VERIFICATION)
  avatar           String?
  phone            String?
  bio              String?
  location         String?
  website          String?
  linkedin         String?
  github           String?
  twitter          String?
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @updatedAt
  lastLoginAt      DateTime?
  company          CompanyProfile?
  jobs             Job[]           @relation("JobOwner")
  receivedMessages Message[]       @relation("MessageReceiver")
  messages         Message[]       @relation("MessageSender")
  portfolio        PortfolioItem[]
  proposals        Proposal[]      @relation("ProposalAuthor")
  reviews          Review[]        @relation("ReviewAuthor")
  receivedReviews  Review[]        @relation("ReviewReceiver")
  profile          UserProfile?

  @@map("users")
}

model UserProfile {
  id                    String   @id @default(cuid())
  userId                String   @unique
  title                 String?
  company               String?
  experience            Int?
  hourlyRate            Float?
  availability          String?
  skills                String[]
  languages             String[]
  portfolio             Json?
  isVerified            Boolean  @default(false)
  verificationDocuments Json?
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
  user                  User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("user_profiles")
}

model PortfolioItem {
  id           String    @id @default(cuid())
  userId       String
  title        String
  description  String?
  category     String
  tags         String[]  @default([])
  images       String[]  @default([])
  liveUrl      String?
  githubUrl    String?
  technologies String[]  @default([])
  startDate    DateTime?
  endDate      DateTime?
  isActive     Boolean   @default(true)
  isPublic     Boolean   @default(true)
  featured     Boolean   @default(false)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  user         User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([category])
  @@index([isPublic])
  @@index([featured])
  @@map("portfolio_items")
}

model CompanyProfile {
  id                    String   @id @default(cuid())
  userId                String   @unique
  companyName           String
  tagline               String?
  description           String?
  website               String?
  logo                  String?
  industry              String?
  companySize           String?
  foundedYear           Int?
  headquarters          String?
  phone                 String?
  email                 String?
  address               String?
  linkedin              String?
  twitter               String?
  facebook              String?
  instagram             String?
  values                String[] @default([])
  culture               String?
  benefits              String[] @default([])
  lookingFor            String?
  skillsNeeded          String[] @default([])
  projectTypes          String[] @default([])
  totalProjects         Int      @default(0)
  activeProjects        Int      @default(0)
  totalSpent            Float    @default(0)
  avgProjectValue       Float    @default(0)
  isVerified            Boolean  @default(false)
  verificationDocuments Json?
  isPublic              Boolean  @default(true)
  showStats             Boolean  @default(true)
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
  user                  User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([industry])
  @@index([companySize])
  @@index([isPublic])
  @@map("company_profiles")
}

model Job {
  id          String     @id @default(cuid())
  title       String
  description String
  budget      Float?
  budgetType  String?
  duration    String?
  skills      String[]
  category    String
  subcategory String?
  location    String?
  isRemote    Boolean    @default(false)
  status      String     @default("OPEN")
  ownerId     String
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  deadline    DateTime?
  owner       User       @relation("JobOwner", fields: [ownerId], references: [id], onDelete: Cascade)
  proposals   Proposal[]

  @@map("jobs")
}

model Proposal {
  id                String   @id @default(cuid())
  jobId             String
  authorId          String
  coverLetter       String
  proposedRate      Float?
  estimatedDuration String?
  status            String   @default("PENDING")
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  author            User     @relation("ProposalAuthor", fields: [authorId], references: [id], onDelete: Cascade)
  job               Job      @relation(fields: [jobId], references: [id], onDelete: Cascade)

  @@map("proposals")
}

model Review {
  id         String   @id @default(cuid())
  authorId   String
  receiverId String
  rating     Int
  comment    String?
  jobId      String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  author     User     @relation("ReviewAuthor", fields: [authorId], references: [id], onDelete: Cascade)
  receiver   User     @relation("ReviewReceiver", fields: [receiverId], references: [id], onDelete: Cascade)

  @@map("reviews")
}

model Message {
  id          String   @id @default(cuid())
  senderId    String
  receiverId  String
  content     String
  isRead      Boolean  @default(false)
  messageType String   @default("TEXT")
  attachment  String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  receiver    User     @relation("MessageReceiver", fields: [receiverId], references: [id], onDelete: Cascade)
  sender      User     @relation("MessageSender", fields: [senderId], references: [id], onDelete: Cascade)

  @@map("messages")
}

enum UserType {
  CLIENT
  FREELANCER
  ADMIN
}

enum UserStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
  PENDING_VERIFICATION
}
